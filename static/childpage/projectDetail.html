<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
    <title>项目详情 - 城市360</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon"/>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
    <!-- CSS  -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://cdn.bootcss.com/materialize/0.97.8/css/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/main.css" type="text/css" rel="stylesheet" media="screen,projection"/>    
    <style type="text/css">.BMap_cpyCtrl {display: none;}</style>
    <style type="text/css">.anchorBL{display:none;}</style>
    <style type="text/css">
    ul.breadcrumb {
      padding: 10px 16px;
      list-style: none;
    }
    ul.breadcrumb li {
      display: inline;
      font-size: 18px;
      font-family:"Times New Roman";
    }
    ul.breadcrumb li+li:before {
      padding: 8px;
      color: black;
      content: "/\00a0";
    }
    ul.breadcrumb li a {
      color: black;
      text-decoration: none;
    }
    ul.breadcrumb li:hover a:not(.checked){
      color:#26a69a;
    }
    .checked{
      font-size:20px;
      font-weight:bold;
    }
    .fade-enter-active,.fade-leave-active {
      transition: all .5s;
    }
    .fade-leave-to {
      opacity: 0;
      /* transform:translateX(100%);  */
    }
    .fade-enter{
      opacity: 0;
      /* transform:translateX(-100%);  */
    }
    strong{
      font-size:24px;
    }
</style>
</head>
<body>
  <div id="preloader"></div>

  <img src="../img/loader.gif" style="display:none">
    
  <div id="user">

    <navigation child="" parent="../index.html" :role="role" :src="src" :name="name" @signout="signout"></navigation>
    
    <login @set="setUser"></login>
    
    <signup></signup>

  </div>

  <!-- 导航栏 -->
  <template id="nav">
    <div>
      <ul id="avataractivity" class="dropdown-content" style="transform:translate(0px,64px)">
        <label for="" id="role">角色：{{roleName}}</label>
      <li class="divider"></li>
      <li>
        <a :href="child+'userinfo.html'" style="text-align: center;">个人信息</a>
      </li>
      <li class="divider"></li>
      <li>
        <a href="#!" style="text-align: center;color:red;font-weight: bold;" @click="logout">登出</a>
      </li>
    </ul>
    <ul id="dropdown1" class="dropdown-content" style="transform:translate(0px,64px)">
      <li>
        <a :href="child+'defination.html'" style="text-align: center;">定义</a>
      </li>
      <li>
        <a :href="child+'whatis.html'" style="text-align: center;">改造流程</a>
      </li>
      <li>
        <a :href="parent+'#321'" style="text-align: center;">设计导则</a>
      </li>
      <li>
        <a :href="child+'examples.html'" style="text-align: center;">已完成案例</a>
      </li>
    </ul>
  <nav class="white" role="navigation">
    <div class="nav-wrapper container left-align">
      <ul class="center hide-on-med-and-down">
        <li style="height: 64px;">
          <a id="logo-container" href="#" style="width: inherit;height: inherit;">
            <img src="img/logo.png" alt="" style="height: 80%;margin: 5%;">
          </a>
        </li>
        <li>
          <a href="/">首页</a>
        </li>
        <li>
          <a href="#!" class="dropdown-button" data-activates="dropdown1">关于畸零空间</a>
        </li>
        <li class="right">
          <a id="btnSignup" href="#signupscreen" class="btn purple lighten-4" v-show="role===''">注册</a>
        </li>
        <li class="right">
          <a id="btnSignin" href="#loginscreen" class="btn btn-flat" v-show="role===''">登录</a>
        </li>
        <li class="right" style="height: 64px;">
          <!-- TODO -->
          <a id="btnMyproject" :href="child+'project.html?1'" class="btn purple lighten-4" v-show="role">我的项目</a>
        </li> 
        <li class="right" style="height: 64px;">
          <a id="liAvatar" href="#!" class="dropdown-button" style="height: 64px;width:130px;" data-activates="avataractivity" v-show="role"> 
            <img ref="avatar" id="imgAvatar" :src="src" alt="" class="avatar"
              style="border-radius: 50%;margin-top: 7px;margin-bottom: 7px;width: 50px;">
            <label id="pUsername" class="right" style="display:inline;text-align: center;font-weight: bold;color:black;">{{name}}</label>
          </a>
        </li>
      </ul>


      <!-- 侧边栏 -->
      <ul id="nav-mobile" class="side-nav">
        <li style="height: 64px;">
          <a id="logo-container" href="#" style="width: inherit;height: inherit;">
            <img src="img/logo.png" alt="" style="height: 50px;margin: 7px;">
          </a>
        </li>
        <li class="divider"></li>
        <li>
          <a href="/">
            <i class="material-icons">home</i>首页</a>
        </li>
        <li>
          <a href="childpage/defination.html" style="color:#26a69a">
            <i class="material-icons">create</i>畸零空间定义</a>
        </li>
        <li>
          <a href="childpage/whatis.html" style="color:#26a69a">
            <i class="material-icons">compare_arrows</i>畸零空间改造流程</a>
        </li>
        <li>
          <a href="#321" style="color:#26a69a">
            <i class="material-icons">highlight</i>畸零空间设计导则</a>
        </li>
        <li>
          <a href="childpage/examples.html" style="color:#26a69a">
            <i class="material-icons">done_all</i>已完成案例</a>
        </li>
        <li class="divider"></li>
        <a id="liAvatarSide" href="#!" class="dropdown-button" style="height: 64px" v-show="role">
          <img ref="avatarSide" id="imgAvatarSide" :src="src" alt="" class="avatar"
            style="border-radius: 50%;margin-top: 7px;margin-bottom: 7px;height: 50px;">
          <label id="pUsernameSide" style="font-weight: bold;color:black;position:absolute;transform: translate(18px,6px)">{{name}}</label>
          <label id="roleSide" for="" style="position:absolute;right:16px;transform: translateY(8px)">角色：{{roleName}}</label>
        </a>
        <li>
          <a id="infoSide" href="childpage/userinfo.html" style="color:#26a69a" v-show="role">
            <i class="material-icons">description</i>个人信息</a>
        </li>
          <li>
            <a id="signoutSide" href="#!" style="color:red" @click="logout" v-show="role">
              <i class="material-icons">highlight_off</i>登出</a>
          </li>
        <li>
          <!-- TODO -->
          <a id="btnMyprojectSide" href="childpage/project.html?1" class="btn purple lighten-4" v-show="role">我的项目</a>
        </li>
          <li>
              <a id="btnSigninSide" href="#loginscreen" class="btn btn-flat" v-show="role===''">登录</a>
            </li>
          <li>
            <a id="btnSignupSide" href="#signupscreen" class="btn purple lighten-4" v-show="role===''">注册</a>
          </li>
      </ul>
      <a href="#" data-activates="nav-mobile" class="button-collapse">
        <i class="material-icons">menu</i>
      </a>
    </div>
  </nav>
</div>
</template>

<template id="loginModal">
  <div class="modal" id="loginscreen" style="max-width: 400px;">
    <div class="modal-content" v-if="refresh">
      <div class="row">
        <div class="col s12 center">
          <h3 style="font-weight: 200;">登录</h3>
        </div>
      </div>
      <div class="row">
        <div class="input-field col s12 ">
          <i class="material-icons prefix">person</i>
          <input id="email_login" type="text" class="validate" v-model="email">
          <label for="email_login">邮箱</label>
        </div>
      </div>
      <div class="row">
        <div class="input-field col s12 ">
          <i class="material-icons prefix">lock</i>
          <input id="password_login" type="password" class="validate" v-model="password">
          <label for="password_login">密码</label>
        </div>
      </div>
      <div class="row">
        <div class="col s12 center">
          <a href="#!" class="btn btn-large btn-block purple lighten-4" @click="signin">登录</a>
        </div>
      </div>
    </div>
  </div>
</template>

<template id="signupModal">
  <div class="modal" id="signupscreen" style="max-width: 600px;">
    <div class="modal-content" v-if="refresh">
      <div class="row">
        <div class="col s12 center ">
          <h3 style="font-weight: 200;">注册新用户</h3>
        </div>
        <div class="input-field  col s12">
          <i class="material-icons prefix">person</i>
          <input id="username" type="text" :class="['validate', {'invalid': invalidth===1}]" v-model="name">
          <label for="username">用户名</label>
        </div>
        <div class="input-field col s12">
          <i class="material-icons prefix">mail</i>
          <input ref="mail" id="mailaddr" type="email" :class="['validate', {'invalid': invalidth===2}]" v-model="email">
          <label for="mailaddr">邮箱</label>
        </div>
        <div class="input-field col s12">
          <i class="material-icons prefix">lock</i>
          <input id="password" type="password" :class="['validate', {'invalid': invalidth===3||invalidth===5}]" v-model="password">
          <label for="password">密码</label>
        </div>
        <div class="input-field col s12">
          <i class="material-icons prefix">repeat</i>
          <input id="password-re" type="password" :class="['validate', {'invalid': invalidth===4||invalidth===5}]" v-model="passwordre">
          <label for="password-re">重复密码</label>
        </div>
        <div class="input-field col s12">
          <i class="material-icons prefix">phone</i>
          <input id="telnum" type="text" class="validate" v-model="tel">
          <label for="telnum">您的联系方式</label>
        </div>
        <div class="col s12">
          <label for="tabs">请选择您的身份</label>
        </div>
        <div class="col s12">
          <ul class="tabs left-align" style="background: transparent;">
            <li class="tab col s2"><a class="" href="#signupDesigner" @click="job=1">设计师</a></li>
            <li class="tab col s2"><a class="" href="#signupGov" @click="job=2">政府机构</a></li>
            <li class="tab col s2"><a class="" href="#signupCmt" @click="job=3">居委会</a></li>
            <li class="tab col s2"><a class="" href="#signupCtz" @click="job=4">居民</a></li>
            <li class="tab col s2"><a class="" href="#signupWrk" @click="job=5">施工方</a></li>
          </ul>
        </div>
        <div class="col s12">&nbsp</div>
        <div class="row">
          <div class="col s12">
            <a href="#!" class="btn btn-large btn-block purple lighten-4" @click="signup">注册</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>


  <div class="modal" id="infoscreen" style="width: 200px;">
    <div class="modal-content">
      <p id="infotext">上传成功!</p>
      <a href="#!" class="btn purple lighten-4 right" style="margin-bottom: 20px;" onclick="closeAllModal()">确定</a>
    </div>
  </div>
    
  <div class="section purple lighten-4" id="index-banner2">
    <div class="container">
      <div class="row">
        <div class="col s12">
          <h1 class="header white-text">项目详情</h1>
        </div>
      </div>
    </div>
  </div>

<section class="ws-section-spacing bg-gray" id="project">
    <div class="container z-depth-2">  
      <div style="padding: 30px">
          <div class="row">
              <div class="col s11">
                  <h3 class="left" style="font-size:30px;padding:20px">基本信息</h3>
                </div>
              <div class="col s1">
                  <a href="#!" class="right" style="color:black" @click="updateProject" v-show="ifModified"><i class="material-icons prefix">save</i></a>
              </div>
            <div class="col m4 s8" style="height:300px;">
              <img :src="pic_url" alt="" style="width:100%;vertical-align: middle;height:300px;">
            </div>
            <div class="input-field col s4 m4">
              <i class="material-icons prefix">title</i>
              <input id="name" type="text" disabled>
              <label for="name" style="color:black">名称:{{name}}</label>
            </div>
            <div class="input-field col s4 m4">
                <i class="material-icons prefix">account_box</i>
                <input id="author" type="text" disabled>
                <label for="author" style="color:black">发起者:{{author}}</label>
              </div>
            <div class="input-field col s4 m4">
              <i class="material-icons prefix">phone</i>
              <input id="tel" type="text" disabled>              
              <label for="tel" style="color:black">联系方式:{{tel}}</label>
            </div>
            <div class="input-field col s4 m4" @mouseover="ifAuthor?ifHover_=true:''" @mouseout="ifHover_=false">
              <i class="material-icons prefix">monetization_on</i>
              <input id="budget" type="text" :disabled="!ifModified" v-model="budgetMod">              
              <label for="budget" id="budgetlabel" style="color:black">预算:{{budget}}</label>
              <a href="#!" class="right" style="transform: translate(-45px,0px);color:black" v-show="ifHover_&&state!=5" @click="enableBudget"><i class="material-icons prefix">mode_edit</i></a>
            </div>
            <div class="input-field col s8 m5">
              <i class="material-icons prefix">star</i>
              <input id="demand" type="text" disabled>              
              <label for="demand" style="color:black">改造意向:{{demand}}</label>
            </div>
            <div class="input-field col s4 m3" @mouseover="ifAuthor?ifHover=true:''" @mouseout="ifHover=false">
                <i class="material-icons prefix">timeline</i>
                <input id="state" type="text" disabled>              
                <label for="state" style="color:black">状态:{{showStatus}}</label>
              <a href="#!" class="dropdown-button right" style="transform: translate(-45px,0px);color:black" data-activates="statedropdown" v-show="ifHover&&state!=5" @click="ifModified=true"><i class="material-icons prefix">mode_edit</i></a>
            </div>
            <!-- Dropdown Structure -->
       <div id="statedropdown" class="dropdown-content" style="transform:translate(0px,40px);min-height:260px;min-width:150px;">
          <form action="#">
            <p>
                <input name="group1" class="with-gap" type="radio" id="radio0" disabled/>
                <label for="radio0">提出</label>
              </p>
            <p>
              <input name="group1" class="with-gap" type="radio" id="radio1" v-bind:value="2"  v-model="state"/>
              <label for="radio1">设计中</label>
            </p>
            <p>
              <input name="group1" class="with-gap" type="radio" id="radio2" v-bind:value="3"  v-model="state"/>
              <label for="radio2">征求意见</label>
            </p>
            <p>
              <input class="with-gap" name="group1" type="radio" id="radio3" v-bind:value="4"  v-model="state"/>
              <label for="radio3">施工中</label>
            </p>
            <p>
              <input name="group1" class="with-gap" type="radio" id="radio4" disabled/>
              <label for="radio4">已完成</label>
            </p>
          </form>
        </div>
            <div class="input-field col s8 m8">
              <i class="material-icons prefix">place</i>
              <input id="address" type="text" disabled>              
              <label for="address" style="color:black">地址:{{address}}</label>
            </div>
            <div class="col s12">
              <br>
            </div>
            </div>
            <div class="container">
              <div class="row">
                <div class="col s12">
                  <div id="bdmap" style="width: inherit;height: 250px;"></div>
                </div>
                <div class="col s12">
                  <input disabled id="coords" type="text" class="validate" v-bind:value="'lng：'+lng+'；lat：'+lat">
                </div>
              </div>
            </div>
            <br>
        </div>
    </div>

    <scheme-comp ref="schemeComp" :ifauthor="ifAuthor" :project_id="project_id" @infoPar="finalize"></scheme-comp>

    <comment-comp ref="commentComp" :ifauthor="ifAuthor" :project_id="project_id"></comment-comp>

  </section>

<template id="scheme">
<div class="container z-depth-1" style="height:950px" id="alternativeScheme">  
  <div style="padding: 30px;margin-top:30px;">
      <div class="row">
    <div class="container" style="width:90%">
        <div class="col s12">
            <h3 style="font-size:30px;padding:20px">所有设计方案</h3>
          </div>
          <div class=" col s12 m12">
              <ul class="breadcrumb">
                  <li v-for="design of designs" :key="design.id"><a href="#!" @click="curDesign=design.id" :class="{'checked':curDesign==design.id}">{{final_scheme===design.id?design.name+'(最终方案)':design.name}}</a></li>
              </ul>
          </div>
          <HR style="border:3 dashed;color:#26a69a;margin-left: 20px;margin-bottom: 25px; " width="90%">
      <transition-group name="fade" mode="out-in">
        <div v-for="design of designs" v-show="curDesign==design.id" :key="design.id" style="position:absolute;width:60%">
        <div class="col m5 s10" style="height:650px;">
          <img class="defer" src="" :data-src="design.pic" alt="" style="width:100%;vertical-align: middle">
        </div>
        <div class="col m1 s2" style="height:650px;">
          </div>
        <div class="input-field col s12 m6">
          <i class="material-icons prefix">settings_overscan</i>
          <input type="text" disabled>
          <label style="color:black">大小：{{design.size}}</label>
        </div>
        <div class="input-field col s12 m6">
            <i class="material-icons prefix">panorama_wide_angle</i>
            <input type="text" disabled>
            <label style="color:black">围合：{{design.surround}}</label>
          </div>
        <div class="input-field col s12 m6">
            <i class="material-icons prefix">nature</i>
            <input type="text" disabled>
            <label style="color:black">绿地比例：{{design.green_rate}}</label>
          </div>
        <div class="input-field col s12 m6">
            <i class="material-icons prefix">highlight</i>
            <input type="text" disabled>
            <label style="color:black">功能：{{design.func}}</label>
          </div>
        <div class="input-field col s12 m6">
            <i class="material-icons prefix">style</i>
            <input type="text" disabled>
            <label style="color:black">风格：{{design.style}}</label>
          </div>
        <div class="input-field col s12 m6">
            <i class="material-icons prefix">wallpaper</i>
            <input type="text" disabled>
            <label style="color:black">景观要素：{{design.view_factor}}</label>
          </div>
        <div class="input-field col s12 m6">
            <i class="material-icons prefix">event_seat</i>
            <input type="text" disabled>
            <label style="color:black">座椅数量：{{design.chair_num}}</label>
          </div>
        <div class="input-field col s12 m6">
            <i class="material-icons prefix">map</i>
            <input type="text" disabled>
            <label style="color:black">是否有顶棚：{{design.is_covered}}</label>
          </div>
          <div class="input-field col s12 m6">
              <i class="material-icons prefix">favorite</i>
              <input type="text" disabled>
              <label style="color:black">获得票数：{{design.AlternativeScheme.vote_num}}</label>
            </div>
            <div class="col s12 m12 center">
              <br>
              <br>
            </div>
            <div class="col s12 m12 center">
                <a name="vote" href="#!" class="btn purple lighten-4 centered" @click="vote(design.id)" v-show="final_scheme==null&&!ifauthor" :disabled="ifvoted">投票</a>
            </div>
            <div class="col s12 m12 center">
                <a href="#!" class="btn purple lighten-4 centered" @click="finalize(design.id)" v-show="final_scheme==null&&ifauthor">确定为最终方案</a>
            </div>
        </div>
      </transition-group>
    </div>
  </div>  
</div>
</div>
</template>

<template id="comment">
<div>
<div class="container z-depth-1" style="margin-top: 20px;padding:15px" @mouseover="!ifauthor?ifHover=true:''" @mouseout="ifHover=false">
<div class="row">
<div class="col s11">
    <h3 class="left" style="font-size:30px;padding:20px">评论</h3>
  </div>
  <div class="col s1">
    <a href="#!" class="dropdown-button right" style="color:black" data-activates="commentdropdown" v-show="ifHover"><i class="material-icons prefix">mode_edit</i></a>
  </div>
</div>
  <div class="z-depth-2 container" style="width:90%;margin-top: 30px;padding:20px" v-for="comment of messages">
    <div class="row">
  <div class="col s4 m2">
    <img ref="avatar" v-bind:src="comment.User.avatar" style="border-radius: 50%;overflow:hidden;width:100%;" name="avatar">  
  </div>
  <div class="col s8 m10" style="margin-bottom: 10px">
    <strong><span style="color:#26a69a">{{comment.User.type}}</span>：{{comment.User.nickname}}</strong>
  </div>
  <div class="col s8 m10">
      <p style="font-size:18px;text-indent: 36px;border:1px solid #cccccc;min-height: 100px;width:100%;border-radius: 8px;background-color: #fcfcfc;padding:10px">{{comment.message}}</p>
  </div>
</div>
</div>
</div>
<!-- Dropdown Structure -->
<div id="commentdropdown" class="dropdown-content" ref="dropdown" @click.stop style="transform:translate(0px,40px);min-height:30px;min-width:450px;padding:20px;border-radius: 12px">
  <div class="input-field">
    <textarea id="textarea" class="materialize-textarea" v-model="comment" ></textarea>
    <label for="textarea">写评论</label>
  </div>
  <a href="#!" class="right" style="transform: translate(0px,0px);color:black" @click="addComment"><i class="material-icons prefix">check</i></a>
</div>
</div>
</template>

<footer class="page-footer teal">
    <div class="container">
        <div class="row">
            <div class="col l6 s12">
                <h5 class="white-text">Company Bio</h5>
                <p class="grey-text text-lighten-4">We are a team of college students working on this project like it's
                    our full time job. Any amount would help support and continue development on this project and is
                    greatly appreciated.</p>


            </div>
            <div class="col l3 s12">
                <h5 class="white-text">Settings</h5>
                <ul>
                    <li><a class="white-text" href="#!">Link 1</a></li>
                    <li><a class="white-text" href="#!">Link 2</a></li>
                    <li><a class="white-text" href="#!">Link 3</a></li>
                    <li><a class="white-text" href="#!">Link 4</a></li>
                </ul>
            </div>
            <div class="col l3 s12">
                <h5 class="white-text">Connect</h5>
                <ul>
                    <li><a class="white-text" href="#!">Link 1</a></li>
                    <li><a class="white-text" href="#!">Link 2</a></li>
                    <li><a class="white-text" href="#!">Link 3</a></li>
                    <li><a class="white-text" href="#!">Link 4</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container">
            Made by <a class="brown-text text-lighten-3" href="http://materializecss.com">Materialize</a>
        </div>
    </div>
</footer>


<!--  Scripts-->
<script src="http://libs.baidu.com/jquery/2.1.1/jquery.min.js"></script>
<script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=33X0NsFGdzK75bVRULnf3zGt4Os450GW"></script>
<script src="https://cdn.bootcss.com/materialize/0.97.8/js/materialize.min.js"></script>  
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.js"></script>
<script src="https://cdn.staticfile.org/axios/0.18.0/axios.min.js"></script>
<script src="js/sha1.js"></script>
<script src="js/init.js"></script>
<script src="js/decodeDesign.js"></script>
<script src="js/projectDetail.js"></script>
<script>
    (function ($) {
        "use strict";
        var $main_window = $(window);
        $('.button-collapse').sideNav();
        $('.modal').modal();
        /*====================================
            preloader js
          ===================================*/
        $main_window.on('load', function () {
            $('#preloader').fadeOut('slow');
            var marker = new BMap.Marker({'lat': vm.lat,'lng': vm.lng});
            map.addOverlay(marker);
            $('.defer').each(function(){
            var img = $(this);
            img.attr('src', img.attr('data-src'));
          })
        });
    })(jQuery);
</script>

</body>
</html>
